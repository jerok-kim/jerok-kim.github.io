#패스트캠퍼스, #국비지원교육, #메가바이트스쿨, #MegabyteSchool, #개발자취업부트캠프, #내일배움카드

*last edited 2023.01.26*

# 러스트의 문자열에 대해 쉬운 설명으로 알아보자

러스트의 문자열인 `String`과 `&str`이 어떻게 다른지 알아보자. 그리고 아시아 언어에서 주로 사용되는 멀티 바이트 문자는 어떻게 다뤄야 할지 확인해보자.

## 러스트의 문자열

러스트에서 문자열을 다룰 때 `String` 타입 또는 `&str`타입을 이용한다. 소스 코드에서 큰따옴표(`"`)로 문자열을 감싸는 경우 문자열 리터럴 타입은 `&str`이 된다.

`&str`은 변경이 불가능하다. 그래서 값을 변경하거나 함수의 반환 값으로 사용해야 하는 경우에는 `String`타입을 사용한다.

### String 타입은 벡터

`String`타입은 러스트 내부에서 `Vec<u8>`타입으로 취급된다. `Vec`은 가변 길이의 배열인 벡터 타입이다. 그리고 `u8`은 부호가 없는 8비트 정수, 즉 1바이트 정수다. 즉 `String`타입은 1바이트 단위로 데이터를 확장할 수 있다. 벡터 타입은 힙 메모리에 저장되므로 확장 가능한 문자열 객체이다.

### &str 타입은 슬라이스

소스 코드에서 큰따옴표로 감싼 문자열이 `&str`이다. `&str`은 러스트 내부에서 슬라이스인 `&[u8]`타입으로 취급된다. 슬라이스는 배열의 일부 또는 전체를 참조자로 이용할 수 있는 데이터 타입이다. 그리고 참조자이므로 소유권과 관련이 없다.

### C/C++와의 차이점

C 언어에서도 문자열은 1바이트 단위의 가변 배열 데이터로 취급한다. 하지만 러스트는 C 언어와 달리 문자열 끝에 `NULL`(`\0`)이 없다. 벡터 타입이므로 바이트 수가 기록되어 안전하게 관리된다.

![러스트와 C 언어의 문자열 표현 차이](./images/string_01.png)

- C 언어에서는 문자열의 끝이 `NULL`(`\0`)이므로 문자열 크기를 알려주지 않으면 알 수 없음
- 러스트에서는 처음부터 문자열의 실제 길이(length)와 메모리에 저장되는 크기(capacity)가 기록됨

## 러스트의 문자열은 UTF-8

러스트에서 다루는 문자열은 `String` 타입이건 `&str` 타입이건 문자 인코딩은 UTF-8로 정해져 있다. UTF-8은 Unicode/UCS로 정의된 문자 집합을 표현하는 문자 인코딩(부호화 방식/문자 코드)이다.

UTF-8의 특징 중 하나는 1글자를 표시하기 위해 1바이트에서 6바이트 사이의 가변 길이를 이용한다는 점이다. 알파벳이나 숫자는 1바이트를 차지하지만 한글이나 일본어는 3바이트를 차지한다.<sup>*</sup>

<sup>*</sup>유니코드로는 2바이트지만 UTF-8로 표현할 때 3바이트가 된다. 따라서 UTF-8 인코딩을 기본으로 사용하는 러스트에서는 인덱스보다 인덱스의 범위를 지정할 수 있는 슬라이스를 기본적으로 사용한다.

`String`이 `Vec<u8>`이고 `&str`이 `&[u8]`이므로 문자열에서 임의의 1바이트에 접근하는 것도 가능하다. 하지만 **바이트 단위로 접근할 때에는 N바이트째가 N글자에 해당하지 않을 수 있다**는 점도 기억해둬야 한다.

영어 문자열과 바이트열이 대응하는 것을 확인해보자. 'Rust'라는 문자는 다음과 같이 대응된다. 바이트열은 16진수로 표기된다.

- 'Rust'라는 문자열을 바이트로 표시

|문자열|R|u|s|t|
|---|---|---|---|---|
|바이트열|52|75|73|74|

영어와 숫자는 UTF-8과 ASCII 코드가 동일하다. 그리고 N바이트째 문자는 N번째 문자가 된다.

다음은 '러스트'라는 UTF-8 문자열을 바이트로 표시한 것이다.

- '러스트'라는 문자열을 바이트로 표시

|문자열|러|스|트|
|---|---|---|---|
|바이트열|eb 9f ac|ec 8a a4|ed 8a b8|

'러'는 16진수 바이트로 표시하면 'eb 9f ac'의 3바이트, '스'는 'ec 8a a4'의 3바이트, '트'는 'ed 8a b8'의 3바이트다. 즉 문자열에서 2바이트째 값을 가져와도 '스'라는 문자에 해당하는 것이 아니라 '러'의 2바이트째인 '9f'라는 데이터를 가져오는 것이다.

러스트의 문자열 `String`및 `&str`에는 문자 단위로 데이터를 가져오는 `chars` 메서드와 바이트 단위로 데이터를 가져오는 `bytes` 메서드가 있다. 이 두 메서드의 차이점에 대해 알아보자.

### 문자열에서 문자 한 개씩 가져오기

문자열을 하나 만든 뒤 임의의 곳에서 문자 한 개를 가져오는 프로그램을 만들어보자.